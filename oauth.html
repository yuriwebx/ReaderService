<!DOCTYPE html>
<html>
<head>
	<title>Oauth Parser</title>
</head>
<body>
	<script type="text/javascript">
		var query = (window.location.search || window.location.hash).substr(1).split('&');
		for(var i = 0; i<query.length; i++){
			if(query[i].indexOf('state=')>-1){
				var parsedObject = JSON.parse(atob(decodeURIComponent(query[i].replace('state=',''))));
				if (parsedObject && parsedObject.hasOwnProperty('link') && parsedObject.hasOwnProperty('provider')){
					query[i] = 'state=' + parsedObject.provider;
					window.location.href = parsedObject.link.split('#')[0] + '#' +query.join('&');
					break; // is it necessary?
				}
			}
		}
	</script>
</body>
</html>